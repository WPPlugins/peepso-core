!function(a){function b(b){var c,d,e=a(".ps-js-field-toggle-all"),f=e.find("span").first(),g=e.find("span").last();"undefined"==typeof b&&(c=0,d=0,b=0,a(".ps-js-fields-container").find(".ps-js-field").each(function(){c++,a(this).is(":visible")&&d++}),d>=c&&(b=1)),0===+b?(e.data("status",0),g.html(e.data("expand-text")),f.removeClass("fa-compress").addClass("fa-expand")):(e.data("status",1),g.html(e.data("collapse-text")),f.removeClass("fa-expand").addClass("fa-compress"))}var c=a(".ps-js-fields-container");c.on("input",".ps-js-field input[type=text]",function(){var b=a(this).closest(".ps-js-fieldconf"),c=b.find(".ps-js-btn");c.show()}).on("keydown",".ps-js-field input[type=text]",function(b){var c,d;13===b.keyCode&&(b.preventDefault(),b.stopPropagation(),c=a(this).closest(".ps-js-fieldconf"),d=c.find(".ps-js-save"),d.click())}).find(".ps-js-field input[type=text]").each(function(){a(this).data("original-value",this.value)}),c.on("click",".ps-js-field .ps-js-cancel",function(){var b=a(this).closest(".ps-js-fieldconf"),c=b.find(".ps-js-btn"),d=b.find("input[type=text]");c.hide(),d.val(d.data("original-value")),d.tooltip("destroy")}),c.on("click",".ps-js-field .ps-js-save",function(){var b,c,d=a(this).closest(".ps-js-fieldconf"),e=d.find(".ps-js-btn"),f=d.find("input[type=text]"),g=d.find(".ps-js-progress");if(b="adminConfigFields.set_"+("meta"===f.data("prop-type")?"meta":"prop"),c={id:f.data("parent-id")||void 0,prop:f.data("prop-name")||void 0,key:f.data("prop-key")||void 0,value:f.val()},"validation"===c.prop){var h,i,j,k,l,m=/^[a-z]+(min|max)_value$/,n=c.key.match(m),o=!1;if(n&&(""===a.trim(c.value)||isNaN(c.value)||+c.value<0?o=peepsoadminprofilesdata.number_invalid:(k=c.key.replace(n[1],"min"===n[1]?"max":"min"),h=d.closest(".ps-tab__content"),i=h.find('[data-prop-key="'+k+'"]'),j=h.find('[data-prop-key="'+k.replace("_value","")+'"]'),j[0].checked&&(l=i.data("original-value")||i.val(),"min"===n[1]&&+l<+c.value?(o=peepsoadminprofilesdata.min_invalid,o=o.replace(/%d/g,+l)):"max"===n[1]&&+l>+c.value&&(o=peepsoadminprofilesdata.max_invalid,o=o.replace(/%d/g,+l))))),o)return f.attr("title",o),f.addClass("tooltip-error"),void f.tooltip({placement:"left",trigger:"manual"}).tooltip("show");f.tooltip("destroy")}g.find("img").show(),f.attr("readonly","readonly"),$PeepSo.postJson(b,c,function(b){g.find("img").hide(),g.find("i").show().delay(800).fadeOut(),f.removeAttr("readonly"),b.success&&(e.hide(),f.data("original-value",c.value),"post_title"==f.data("prop-name")&&a("#field-"+c.id+"-box-title").html(c.value))})}),c.on("click","input[type=checkbox]",_.throttle(function(){var b,c,d=a(this),e=d.closest(".ps-js-fieldconf").find(".ps-js-progress"),f=d[0].checked,g=!1;if(b="adminConfigFields.set_"+("meta"===d.data("prop-type")?"meta":"prop"),c={id:d.data("parent-id")||void 0,prop:d.data("prop-name")||void 0,key:d.data("prop-key")||void 0,value:f?d.val():d.data("disabled-value")},f&&"validation"===c.prop){var h,i,j,k,l,m,n,o=/^[a-z]+(min|max)$/,p=c.key.match(o);p&&(m=c.key.replace(p[1],"min"===p[1]?"max":"min"),h=d.closest(".ps-tab__content"),k=h.find('[data-prop-key="'+m+'"]'),l=h.find('[data-prop-key="'+m+'_value"]'),k[0].checked&&(n=l.data("original-value")||l.val(),"min"===p[1]&&+n<+c.value?g=!0:"max"===p[1]&&+n>+c.value&&(g=!0)),g&&(i=h.find('[data-prop-key="'+c.key+'_value"]'),j=i.nextAll(".ps-js-save"),i.val(n)))}e.find("i").stop().hide(),e.find("img").show(),d.attr("readonly","readonly"),$PeepSo.postJson(b,c,function(b){if(e.find("img").hide(),e.find("i").show().delay(800).fadeOut(),d.removeAttr("readonly"),b.success)if(g&&j.trigger("click"),$value_container_id="#"+d[0].id+"-value-container",$container_id="#"+d[0].id+"-container",f?a($value_container_id).fadeIn(500):a($value_container_id).fadeOut(500),"validation"===c.prop&&"required"===c.key){var h=a("#field-"+c.id+"-required-mark");f?h.removeClass("hidden"):h.addClass("hidden")}else"post_status"===c.prop&&(f?d.closest(".postbox").removeClass("postbox-muted"):d.closest(".postbox").addClass("postbox-muted"))})},1e3)),c.on("change","select",_.throttle(function(){var b,c,d=a(this),e=d.closest(".ps-js-fieldconf").find(".ps-js-progress");b="adminConfigFields.set_"+("meta"===d.data("prop-type")?"meta":"prop"),c={id:d.data("parent-id")||void 0,prop:d.data("prop-name")||void 0,key:d.data("prop-key")||void 0,value:d.val()},e.find("i").stop().hide(),e.find("img").show(),d.attr("readonly","readonly"),$PeepSo.postJson(b,c,function(a){e.find("img").hide(),e.find("i").show().delay(800).fadeOut(),d.removeAttr("readonly"),a.success})},1e3)),c.sortable({handle:".ps-js-handle",update:_.throttle(function(){var b=[];a(".ps-js-fields-container .postbox").each(function(){b.push(a(this).data("id"))}),$PeepSo.postJson("adminConfigFields.set_order",{fields:JSON.stringify(b)},function(a){})},3e3)}),c.on("click",".ps-js-field-toggle",function(){var c=a(this),d=c.closest(".postbox"),e=d.find(".ps-js-field"),f=d.data("id");e.is(":visible")?e.slideUp("fast",function(){c.removeClass("fa-compress").addClass("fa-expand"),b(),g(f,0)}):e.slideDown("fast",function(){c.removeClass("fa-expand").addClass("fa-compress"),b(),g(f,1)})}),c.on("click",".ps-js-field-title",function(b){b.target===b.currentTarget&&a(this).closest(".ps-postbox__title").find(".ps-js-field-toggle").click()});var d;c.on("mousedown",".ps-postbox__title",function(b){var c=a(b.currentTarget);d=setTimeout(function(){c.addClass("ps-js-mousedown")},200)}).on("mouseup mouseleave",".ps-postbox__title",function(b){clearTimeout(d),a(b.currentTarget).removeClass("ps-js-mousedown")}),a(".ps-js-field-expand-all").on("click",function(){c.find(".ps-js-field").slideDown("fast",function(){e(1)})}),a(".ps-js-field-collapse-all").on("click",function(){c.find(".ps-js-field").slideUp("fast",function(){e(0)})});var e=_.debounce(function(c){var d=a(".ps-js-fields-container").children(".postbox");0===c?d.find(".ps-js-field-toggle").removeClass("fa-compress").addClass("fa-expand"):d.find(".ps-js-field-toggle").removeClass("fa-expand").addClass("fa-compress"),b(c),g("all",c)},200);b();var f={},g=_.debounce(function(b,c){var d=[];"all"!==b?d=[b]:a(".ps-js-fields-container").children(".postbox").each(function(){d.push(a(this).data("id"))}),f[b]&&f[b].ret&&f[b].ret.abort(),f[b]=$PeepSo.postJson("adminConfigFields.set_admin_box_status",{id:JSON.stringify(d),status:c},function(a){})},500);a(".ps-js-field-new").on("click",function(){var b="no-plugin-warning",c=a("#"+b);if(!c.length){var d=window.peepsoadminprofilesdata||{};c=a(d.popup_template),c.prop("id",b),c.appendTo(document.body),c.on("click",".button-link",function(){c.hide()}),c.on("click",".button-primary",function(a){a.preventDefault(),a.stopPropagation(),c.hide(),window.open(d.plugin_url)})}c.show()}),c.on("click",".ps-tabs a",function(){var b=a(this),c=b.closest(".ps-tabs").find(".active");return c.removeClass("active"),b.addClass("active"),a(c.attr("href")).hide(),a(b.attr("href")).show(),!1}),c.on("click",".ps-postbox__title .fa-edit",function(){var b=a(this).closest(".ps-postbox__title"),c=b.find(".ps-postbox__title-label"),d=b.find(".ps-postbox__title-editor"),e=d.find("input[type=text]"),f=(e.nextAll(".ps-js-save"),e.data("prop-title-is-default")),g=e.val();c.hide(),d.show(),e.data("original-value",g).focus(),e.val(f?"":g).trigger("input")}),c.on("click",".ps-js-field-title-text",function(){var b=a(this).closest(".ps-postbox__title"),c=b.find(".fa-edit");c.click()}),c.on("click",".ps-postbox__title .ps-js-cancel",function(){var b=a(this).closest(".ps-postbox__title"),c=b.find(".ps-postbox__title-label"),d=b.find(".ps-postbox__title-editor"),e=d.find("input[type=text]");e.val(e.data("original-value")),d.hide(),c.show()}),c.on("click",".ps-postbox__title .ps-js-save",function(){var b,c,d=a(this).closest(".ps-postbox__title"),e=d.find(".ps-postbox__title-label"),f=d.find(".ps-postbox__title-editor"),g=f.find("input[type=text]"),h=d.find(".ps-js-progress");b="adminConfigFields.set_"+("meta"===g.data("prop-type")?"meta":"prop"),c={id:g.data("parent-id")||void 0,prop:g.data("prop-name")||void 0,key:g.data("prop-key")||void 0,value:g.val()},h.find("img").show(),g.attr("readonly","readonly"),$PeepSo.postJson(b,c,function(b){h.find("img").hide(),h.find("i").show().delay(800).fadeOut(),g.removeAttr("readonly"),b.success&&(f.hide(),e.show(),g.data("original-value",c.value),g.data("prop-title-is-default",!1),a("#field-"+c.id+"-box-title").html(c.value))})}),c.on("keydown",".ps-postbox__title input[type=text]",function(b){var c;13===b.keyCode&&(b.preventDefault(),b.stopPropagation(),c=a(this).nextAll(".ps-js-save"),c.click())}).on("input",".ps-postbox__title input[type=text]",function(b){var c=a(this).nextAll(".ps-js-save");a.trim(this.value)?c.removeAttr("disabled"):c.attr("disabled","disabled")}),c.on("focus",".ps-js-focusguard",function(){var b=a(this),c=b.closest(".ps-js-options").children(".ps-js-fieldconf");"last"===b.data("tag")?c.find("input").first().focus():c.find("input").last().focus()}),a(function(){var b=a(".ps-settings__bar");b.addClass("ps-settings__bar--static"),a(window).scroll(function(){var b=a(".ps-settings__bar"),c=a(this).scrollTop();c>50?b.removeClass("ps-settings__bar--static"):b.addClass("ps-settings__bar--static")})})}(jQuery);