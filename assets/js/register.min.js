!function(a){function b(b){var c,d,e,f,g,h,i,j=a(b),k=j.find("input[type=text],input[type=password],input[type=checkbox],input[type=radio],textarea,select");if(k.length)return c=k.eq(0).data("id"),d=k.eq(0).attr("name")||"",e=(k.eq(0).attr("type")||"").toLowerCase(),"checkbox"===e?(f=k.filter(":checked").map(function(){return this.value}),f=a.makeArray(f),f=JSON.stringify(f)):f="radio"===e?k.filter(":checked").val():k.hasClass("datepicker")?k.data("value"):ps_observer.apply_filters("profile_field_save",k.val(),k),["username","email","password","password2"].indexOf(d)>=0?(g=!0,h=peepsodata.ajaxurl_legacy+"profilefieldsajax.validate_register",i={},i.name=d,i[d]=f,"password2"===d&&(k=k.closest(".ps-register-form form").find("[name=password]"),i.password=k.val())):(g=!1,h=peepsodata.ajaxurl_legacy+"profilefieldsajax.validate",i={user_id:peepsodata.currentuserid,view_user_id:peepsodata.userid,id:c,value:f}),a.ajax({url:h,type:"post",dataType:"json",data:i}).done(function(a){var b,c=j.find(".ps-form-error");a.errors&&a.errors.length?(c.empty(),b=g?a.errors:a.errors[0],_.each(b,function(a){c.append("<li>"+a+"</li>")}),c.show()):c.hide()})}function c(c){var d=a(c),e=d.find(".ps-form-field"),f=e.find("input.datepicker"),g=d.find("button[type=submit]"),h=[];errors=[],d.data("ps-submitting")||(d.data("ps-submitting",!0),e.each(function(){var a=b(this);a&&h.push(a)}),g.find("img").show(),a.when.apply(a,h).done(function(){var b,c;g.find("img").hide();for(c in arguments)if(b=arguments[c][0],b.errors)return void d.removeData("ps-submitting");f.length&&f.each(function(){var b=a(this),c=b.data("value");c&&($hidden=a('<input type="hidden" name="'+b.attr("name")+'" />'),b.removeAttr("name"),$hidden.insertAfter(b),$hidden.val(c))}),e.length&&e.each(function(){$input=a(this).find("input[type=text],input[type=password],input[type=checkbox],input[type=radio],textarea,select"),ps_observer.do_action("profile_field_save_register",$input)}),d.off("submit.ps-register"),setTimeout(function(){g.click()},100)}))}var d=a(document).find(".ps-register-form form");d.on("input","input[type=text]:not(.ps-js-field-location),input[type=password],textarea",_.debounce(function(c){b(a(c.target).closest(".ps-form-field"))},500)).on("click","input[type=checkbox],input[type=radio]",_.debounce(function(c){b(a(c.target).closest(".ps-form-field"))},100)).on("change","select",_.debounce(function(c){b(a(c.target).closest(".ps-form-field"))},100)).on("submit.ps-register",function(a){return a.preventDefault(),a.stopPropagation(),c(this),!1}),a(function(){setTimeout(function(){d.find(".ps-js-location-wrapper .ps-btn").on("mousedown",_.debounce(function(c){b(a(c.target).closest(".ps-form-field"))},100))},1e3)})}(jQuery);